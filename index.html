<style>
  body {
    margin: 0;
    font-family: 'Open Sans', sans-serif;
    background-color: #f4f1ec;
    color: #333;
  }

  header {
    background-color: #2c3e50;
    color: white;
    padding: 30px 20px;
    text-align: center;
  }

  header h1 {
    margin: 0;
    font-size: 2.5rem;
  }

  header p {
    margin-top: 10px;
    font-size: 1rem;
    opacity: 0.85;
  }

  .container {
    max-width: 1000px;
    margin: 40px auto;
    padding: 25px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .exhibit-image {
    width: 100%;
    border-radius: 8px;
    margin-bottom: 25px;
  }

  .description {
    font-size: 1.1rem;
    line-height: 1.7;
  }

  footer {
    text-align: center;
    padding: 20px;
    margin-top: 40px;
    background-color: #2c3e50;
    color: white;
    font-size: 0.9rem;
  }

  @media (max-width: 768px) {
    header h1 {
      font-size: 1.8rem;
    }

    .container {
      margin: 20px;
    }
  }
</style>

<header>
  <h1>Birkenhead Rolling Wheels</h1>
  <p>Hagley Museum Interactive Exhibit</p>
</header>

<div class="container">
  <img src="test.jpg" alt="Birkenhead Rolling Wheels" class="exhibit-image">

  <p class="description">
    This exhibit highlights the historical use of rolling wheels in the Birkenhead area
    and their role in early industrial processes. Visitors can explore how mechanical
    innovation helped transform manufacturing during the Industrial Revolution.
  </p>
</div>

<footer>
  © Hagley Museum | QR Visitor Interaction System
</footer>

<script>

/* =========================
CONFIG
========================= */
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzm0wgH5Tdlz8KEGJcXRE4jif9Rxn_Ma3Vf_Dn-RhwMbKAT1LnZvLIs0uM1gts01k6rIQ/exec";
const EXHIBIT_NAME = "Birkenhead Rolling Wheels";
const WEATHER_API_KEY = "e23c0a18cd0744e940f5020207c57793";

/* Hagley Museum fixed coordinates */
const LAT = 39.7496;
const LON = -75.6206;


/* =========================
SEND SCAN TO APPS SCRIPT
========================= */
function sendScan(weatherType, temperature){

  const payload = {
    exhibit: EXHIBIT_NAME,
    weather: weatherType,
    temperature: temperature
  };

  console.log("Sending:", payload);

  fetch(SCRIPT_URL,{
    method:"POST",
    mode:"no-cors",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(payload)
  });

}


/* =========================
GET WEATHER FROM OPENWEATHER
========================= */
function logScan(){

  const weatherURL =
  `https://api.openweathermap.org/data/2.5/weather?lat=${LAT}&lon=${LON}&units=imperial&appid=${WEATHER_API_KEY}`;

  console.log("Requesting weather:", weatherURL);

  fetch(weatherURL)
  .then(response => {

    if(!response.ok){
      throw new Error("Weather request failed with status " + response.status);
    }

    return response.json();
  })
  .then(data => {

    console.log("Weather data:", data);

    // Validate structure
    if(!data.main || !data.weather || !data.weather.length){
      throw new Error("Weather response missing fields");
    }

    // ✅ ONLY CHANGE: add °F here
    const temperature = Math.round(data.main.temp) + "°F";
    const weatherType = data.weather[0].description;

    sendScan(weatherType, temperature);

  })
  .catch(error => {

    console.error("Weather error:", error);

    // still log scan but mark weather error clearly
    sendScan("WEATHER_ERROR", "-1°F");

  });

}


/* =========================
RUN WHEN PAGE LOADS
========================= */
logScan();

</script>
</body>
</html>
